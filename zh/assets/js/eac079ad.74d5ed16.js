"use strict";(self.webpackChunk_contexify_docs_site=self.webpackChunk_contexify_docs_site||[]).push([[187],{73:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>d,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"api/usage-examples","title":"API \u7528\u6cd5\u793a\u4f8b","description":"\u672c\u8282\u63d0\u4f9b\u4e86\u4f7f\u7528 Contexify API \u7684\u793a\u4f8b\uff0c\u5e2e\u52a9\u60a8\u66f4\u597d\u5730\u7406\u89e3\u5982\u4f55\u5728\u5b9e\u9645\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u8fd9\u4e9b API\u3002","source":"@site/i18n/zh/docusaurus-plugin-content-docs/current/api/usage-examples.md","sourceDirName":"api","slug":"/api/usage-examples","permalink":"/contexify/zh/docs/api/usage-examples","draft":false,"unlisted":false,"editUrl":"https://github.com/teomyth/contexify/edit/main/docs-site/docs/api/usage-examples.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"\u63a5\u53e3\u548c\u7c7b\u578b","permalink":"/contexify/zh/docs/api/interfaces"},"next":{"title":"Examples","permalink":"/contexify/zh/docs/category/examples"}}');var s=t(7968),r=t(9880);const c={sidebar_position:5},o="API \u7528\u6cd5\u793a\u4f8b",a={},l=[{value:"Context \u7c7b\u793a\u4f8b",id:"context-\u7c7b\u793a\u4f8b",level:2},{value:"\u521b\u5efa Context",id:"\u521b\u5efa-context",level:3},{value:"\u7ed1\u5b9a\u548c\u89e3\u6790\u503c",id:"\u7ed1\u5b9a\u548c\u89e3\u6790\u503c",level:3},{value:"\u7ed1\u5b9a\u7c7b",id:"\u7ed1\u5b9a\u7c7b",level:3},{value:"\u4f7f\u7528\u52a8\u6001\u503c",id:"\u4f7f\u7528\u52a8\u6001\u503c",level:3},{value:"\u4f7f\u7528\u63d0\u4f9b\u8005",id:"\u4f7f\u7528\u63d0\u4f9b\u8005",level:3},{value:"\u4f7f\u7528\u522b\u540d",id:"\u4f7f\u7528\u522b\u540d",level:3},{value:"\u8bbe\u7f6e\u7ed1\u5b9a\u4f5c\u7528\u57df",id:"\u8bbe\u7f6e\u7ed1\u5b9a\u4f5c\u7528\u57df",level:3},{value:"\u4f7f\u7528\u6807\u7b7e",id:"\u4f7f\u7528\u6807\u7b7e",level:3},{value:"\u4f7f\u7528 Context \u89c6\u56fe",id:"\u4f7f\u7528-context-\u89c6\u56fe",level:3},{value:"\u88c5\u9970\u5668\u793a\u4f8b",id:"\u88c5\u9970\u5668\u793a\u4f8b",level:2},{value:"@injectable() \u88c5\u9970\u5668",id:"injectable-\u88c5\u9970\u5668",level:3},{value:"@inject() \u88c5\u9970\u5668",id:"inject-\u88c5\u9970\u5668",level:3},{value:"@inject.tag() \u88c5\u9970\u5668",id:"injecttag-\u88c5\u9970\u5668",level:3},{value:"@inject.getter() \u88c5\u9970\u5668",id:"injectgetter-\u88c5\u9970\u5668",level:3},{value:"@inject.view() \u88c5\u9970\u5668",id:"injectview-\u88c5\u9970\u5668",level:3},{value:"@config() \u88c5\u9970\u5668",id:"config-\u88c5\u9970\u5668",level:3},{value:"@intercept() \u88c5\u9970\u5668",id:"intercept-\u88c5\u9970\u5668",level:3},{value:"\u63a5\u53e3\u793a\u4f8b",id:"\u63a5\u53e3\u793a\u4f8b",level:2},{value:"Provider \u63a5\u53e3",id:"provider-\u63a5\u53e3",level:3},{value:"Interceptor \u63a5\u53e3",id:"interceptor-\u63a5\u53e3",level:3},{value:"ContextObserver \u63a5\u53e3",id:"contextobserver-\u63a5\u53e3",level:3},{value:"\u66f4\u591a\u793a\u4f8b",id:"\u66f4\u591a\u793a\u4f8b",level:2}];function g(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"api-\u7528\u6cd5\u793a\u4f8b",children:"API \u7528\u6cd5\u793a\u4f8b"})}),"\n",(0,s.jsx)(n.p,{children:"\u672c\u8282\u63d0\u4f9b\u4e86\u4f7f\u7528 Contexify API \u7684\u793a\u4f8b\uff0c\u5e2e\u52a9\u60a8\u66f4\u597d\u5730\u7406\u89e3\u5982\u4f55\u5728\u5b9e\u9645\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u8fd9\u4e9b API\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"context-\u7c7b\u793a\u4f8b",children:"Context \u7c7b\u793a\u4f8b"}),"\n",(0,s.jsx)(n.h3,{id:"\u521b\u5efa-context",children:"\u521b\u5efa Context"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u521b\u5efa\u6839 Context\nconst rootContext = new Context('root');\n\n// \u521b\u5efa\u5b50 Context\nconst childContext = new Context(rootContext, 'child');\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u7ed1\u5b9a\u548c\u89e3\u6790\u503c",children:"\u7ed1\u5b9a\u548c\u89e3\u6790\u503c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u7ed1\u5b9a\u7b80\u5355\u503c\ncontext.bind('greeting').to('Hello, world!');\n\n// \u5f02\u6b65\u89e3\u6790\u503c\nconst greeting = await context.get<string>('greeting');\nconsole.log(greeting); // \u8f93\u51fa: Hello, world!\n\n// \u540c\u6b65\u89e3\u6790\u503c\uff08\u5982\u679c\u53ef\u80fd\uff09\nconst greetingSync = context.getSync<string>('greeting');\nconsole.log(greetingSync); // \u8f93\u51fa: Hello, world!\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u7ed1\u5b9a\u7c7b",children:"\u7ed1\u5b9a\u7c7b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@injectable()\nclass GreetingService {\n  sayHello(name: string) {\n    return `Hello, ${name}!`;\n  }\n}\n\n// \u7ed1\u5b9a\u7c7b\ncontext.bind('services.GreetingService').toClass(GreetingService);\n\n// \u89e3\u6790\u7c7b\u5b9e\u4f8b\nconst greetingService = await context.get<GreetingService>('services.GreetingService');\nconsole.log(greetingService.sayHello('John')); // \u8f93\u51fa: Hello, John!\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u4f7f\u7528\u52a8\u6001\u503c",children:"\u4f7f\u7528\u52a8\u6001\u503c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u7ed1\u5b9a\u52a8\u6001\u503c\ncontext.bind('currentTime').toDynamicValue(() => new Date().toISOString());\n\n// \u6bcf\u6b21\u89e3\u6790\u83b7\u53d6\u65b0\u503c\nconst time1 = await context.get<string>('currentTime');\n// \u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\nconst time2 = await context.get<string>('currentTime');\nconsole.log(time1 !== time2); // \u8f93\u51fa: true\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u4f7f\u7528\u63d0\u4f9b\u8005",children:"\u4f7f\u7528\u63d0\u4f9b\u8005"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@injectable()\nclass TimeProvider implements Provider<string> {\n  value() {\n    return new Date().toISOString();\n  }\n}\n\n// \u7ed1\u5b9a\u63d0\u4f9b\u8005\ncontext.bind('currentTime').toProvider(TimeProvider);\n\n// \u89e3\u6790\u503c\nconst time = await context.get<string>('currentTime');\nconsole.log(time); // \u8f93\u51fa\u5f53\u524d\u65f6\u95f4\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u4f7f\u7528\u522b\u540d",children:"\u4f7f\u7528\u522b\u540d"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u7ed1\u5b9a\u503c\ncontext.bind('config.apiUrl').to('https://api.example.com');\n\n// \u521b\u5efa\u522b\u540d\ncontext.bind('apiUrl').toAlias('config.apiUrl');\n\n// \u901a\u8fc7\u522b\u540d\u89e3\u6790\nconst apiUrl = await context.get<string>('apiUrl');\nconsole.log(apiUrl); // \u8f93\u51fa: https://api.example.com\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u8bbe\u7f6e\u7ed1\u5b9a\u4f5c\u7528\u57df",children:"\u8bbe\u7f6e\u7ed1\u5b9a\u4f5c\u7528\u57df"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u5355\u4f8b\u4f5c\u7528\u57df\uff08\u9ed8\u8ba4\uff09\ncontext.bind('singleton').to(new Date()).inScope(BindingScope.SINGLETON);\n\n// \u77ac\u6001\u4f5c\u7528\u57df\uff08\u6bcf\u6b21\u89e3\u6790\u521b\u5efa\u65b0\u5b9e\u4f8b\uff09\ncontext.bind('transient').toDynamicValue(() => new Date()).inScope(BindingScope.TRANSIENT);\n\n// \u4e0a\u4e0b\u6587\u4f5c\u7528\u57df\uff08\u5728\u540c\u4e00\u4e0a\u4e0b\u6587\u4e2d\u5171\u4eab\u5b9e\u4f8b\uff09\ncontext.bind('contextScoped').toDynamicValue(() => new Date()).inScope(BindingScope.CONTEXT);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u4f7f\u7528\u6807\u7b7e",children:"\u4f7f\u7528\u6807\u7b7e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u6dfb\u52a0\u6807\u7b7e\ncontext.bind('service.user').toClass(UserService).tag('service');\ncontext.bind('service.order').toClass(OrderService).tag('service');\ncontext.bind('service.payment').toClass(PaymentService).tag('service');\n\n// \u901a\u8fc7\u6807\u7b7e\u67e5\u627e\u7ed1\u5b9a\nconst serviceBindings = await context.findByTag('service');\nconsole.log(serviceBindings.length); // \u8f93\u51fa: 3\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u4f7f\u7528-context-\u89c6\u56fe",children:"\u4f7f\u7528 Context \u89c6\u56fe"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u521b\u5efa\u8ddf\u8e2a\u6240\u6709\u5e26\u6709 'service' \u6807\u7b7e\u7684\u7ed1\u5b9a\u7684\u89c6\u56fe\nconst serviceView = context.createView<any>(binding => binding.tags.has('service'));\n\n// \u83b7\u53d6\u6240\u6709\u5339\u914d\u7684\u7ed1\u5b9a\nconst bindings = serviceView.bindings();\nconsole.log(bindings.length); // \u8f93\u51fa: 3\n\n// \u89e3\u6790\u6240\u6709\u5339\u914d\u7684\u503c\nconst services = await serviceView.resolve();\nconsole.log(services.length); // \u8f93\u51fa: 3\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u88c5\u9970\u5668\u793a\u4f8b",children:"\u88c5\u9970\u5668\u793a\u4f8b"}),"\n",(0,s.jsx)(n.h3,{id:"injectable-\u88c5\u9970\u5668",children:"@injectable() \u88c5\u9970\u5668"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@injectable()\nclass UserService {\n  constructor() {\n    console.log('UserService created');\n  }\n\n  getUsers() {\n    return ['user1', 'user2', 'user3'];\n  }\n}\n\n// \u73b0\u5728 UserService \u53ef\u4ee5\u901a\u8fc7 Context \u521b\u5efa\ncontext.bind('services.UserService').toClass(UserService);\nconst userService = await context.get<UserService>('services.UserService');\n"})}),"\n",(0,s.jsx)(n.h3,{id:"inject-\u88c5\u9970\u5668",children:"@inject() \u88c5\u9970\u5668"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@injectable()\nclass UserRepository {\n  findAll() {\n    return ['user1', 'user2', 'user3'];\n  }\n}\n\n@injectable()\nclass UserService {\n  constructor(@inject('repositories.UserRepository') private userRepo: UserRepository) {}\n\n  getUsers() {\n    return this.userRepo.findAll();\n  }\n}\n\n// \u7ed1\u5b9a\u4f9d\u8d56\u9879\ncontext.bind('repositories.UserRepository').toClass(UserRepository);\ncontext.bind('services.UserService').toClass(UserService);\n\n// \u89e3\u6790 UserService\uff08UserRepository \u81ea\u52a8\u6ce8\u5165\uff09\nconst userService = await context.get<UserService>('services.UserService');\nconsole.log(userService.getUsers()); // \u8f93\u51fa: ['user1', 'user2', 'user3']\n"})}),"\n",(0,s.jsx)(n.h3,{id:"injecttag-\u88c5\u9970\u5668",children:"@inject.tag() \u88c5\u9970\u5668"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@injectable()\nclass Logger {\n  constructor(private name: string) {}\n\n  log(message: string) {\n    console.log(`[${this.name}] ${message}`);\n  }\n}\n\n@injectable()\nclass Application {\n  constructor(@inject.tag('logger') private loggers: Logger[]) {}\n\n  run() {\n    this.loggers.forEach(logger => logger.log('Application started'));\n  }\n}\n\n// \u7ed1\u5b9a\u591a\u4e2a\u5e26\u6709\u76f8\u540c\u6807\u7b7e\u7684\u670d\u52a1\ncontext.bind('loggers.console').toClass(Logger).tag('logger').to(new Logger('console'));\ncontext.bind('loggers.file').toClass(Logger).tag('logger').to(new Logger('file'));\ncontext.bind('app').toClass(Application);\n\n// \u89e3\u6790\u5e94\u7528\u7a0b\u5e8f\uff08\u6240\u6709\u5e26\u6709 'logger' \u6807\u7b7e\u7684\u670d\u52a1\u81ea\u52a8\u6ce8\u5165\uff09\nconst app = await context.get<Application>('app');\napp.run();\n// \u8f93\u51fa:\n// [console] Application started\n// [file] Application started\n"})}),"\n",(0,s.jsx)(n.h3,{id:"injectgetter-\u88c5\u9970\u5668",children:"@inject.getter() \u88c5\u9970\u5668"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@injectable()\nclass ConfigService {\n  constructor(@inject.getter('config.database') private getDbConfig: Getter<any>) {}\n\n  async connectToDatabase() {\n    // \u4ec5\u5728\u9700\u8981\u65f6\u83b7\u53d6\u914d\u7f6e\n    const dbConfig = await this.getDbConfig();\n    console.log(`Connecting to ${dbConfig.host}:${dbConfig.port}`);\n  }\n}\n\n// \u7ed1\u5b9a\u914d\u7f6e\ncontext.bind('config.database').to({\n  host: 'localhost',\n  port: 5432,\n  username: 'admin',\n  password: 'secret'\n});\n\ncontext.bind('services.ConfigService').toClass(ConfigService);\n\n// \u89e3\u6790\u670d\u52a1\nconst configService = await context.get<ConfigService>('services.ConfigService');\nawait configService.connectToDatabase(); // \u8f93\u51fa: Connecting to localhost:5432\n"})}),"\n",(0,s.jsx)(n.h3,{id:"injectview-\u88c5\u9970\u5668",children:"@inject.view() \u88c5\u9970\u5668"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@injectable()\nclass Plugin {\n  constructor(public name: string) {}\n\n  initialize() {\n    console.log(`Plugin ${this.name} initialized`);\n  }\n}\n\n@injectable()\nclass PluginManager {\n  constructor(\n    @inject.view(binding => binding.tags.has('plugin'))\n    private pluginView: ContextView<Plugin>\n  ) {}\n\n  async initializePlugins() {\n    const plugins = await this.pluginView.resolve();\n    plugins.forEach(plugin => plugin.initialize());\n  }\n}\n\n// \u7ed1\u5b9a\u63d2\u4ef6\u548c\u7ba1\u7406\u5668\ncontext.bind('plugins.logger').to(new Plugin('logger')).tag('plugin');\ncontext.bind('plugins.auth').to(new Plugin('auth')).tag('plugin');\ncontext.bind('plugins.cache').to(new Plugin('cache')).tag('plugin');\ncontext.bind('managers.PluginManager').toClass(PluginManager);\n\n// \u89e3\u6790\u7ba1\u7406\u5668\u5e76\u521d\u59cb\u5316\u63d2\u4ef6\nconst pluginManager = await context.get<PluginManager>('managers.PluginManager');\nawait pluginManager.initializePlugins();\n// \u8f93\u51fa:\n// Plugin logger initialized\n// Plugin auth initialized\n// Plugin cache initialized\n"})}),"\n",(0,s.jsx)(n.h3,{id:"config-\u88c5\u9970\u5668",children:"@config() \u88c5\u9970\u5668"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@injectable()\nclass DatabaseService {\n  constructor(\n    @config('database.host') private host: string,\n    @config('database.port') private port: number\n  ) {}\n\n  connect() {\n    console.log(`Connecting to database at ${this.host}:${this.port}`);\n  }\n}\n\n// \u7ed1\u5b9a\u914d\u7f6e\ncontext.configure('services.DatabaseService').to({\n  database: {\n    host: 'localhost',\n    port: 5432\n  }\n});\n\ncontext.bind('services.DatabaseService').toClass(DatabaseService);\n\n// \u89e3\u6790\u670d\u52a1\nconst dbService = await context.get<DatabaseService>('services.DatabaseService');\ndbService.connect(); // \u8f93\u51fa: Connecting to database at localhost:5432\n"})}),"\n",(0,s.jsx)(n.h3,{id:"intercept-\u88c5\u9970\u5668",children:"@intercept() \u88c5\u9970\u5668"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u5b9a\u4e49\u62e6\u622a\u5668\nclass LoggingInterceptor implements Interceptor {\n  intercept(invocationCtx: InvocationContext, next: () => ValueOrPromise<any>) {\n    console.log(`Calling ${invocationCtx.methodName} with args:`, invocationCtx.args);\n    const start = Date.now();\n    const result = next();\n\n    if (result instanceof Promise) {\n      return result.then(value => {\n        console.log(`${invocationCtx.methodName} completed in ${Date.now() - start}ms`);\n        return value;\n      });\n    }\n\n    console.log(`${invocationCtx.methodName} completed in ${Date.now() - start}ms`);\n    return result;\n  }\n}\n\n// \u4f7f\u7528\u62e6\u622a\u5668\n@injectable()\nclass UserService {\n  @intercept(new LoggingInterceptor())\n  async findUsers() {\n    // \u6a21\u62df\u6570\u636e\u5e93\u67e5\u8be2\n    await new Promise(resolve => setTimeout(resolve, 100));\n    return ['user1', 'user2', 'user3'];\n  }\n}\n\n// \u7ed1\u5b9a\u670d\u52a1\ncontext.bind('services.UserService').toClass(UserService);\n\n// \u89e3\u6790\u670d\u52a1\u5e76\u8c03\u7528\u65b9\u6cd5\nconst userService = await context.get<UserService>('services.UserService');\nconst users = await userService.findUsers();\n// \u8f93\u51fa:\n// Calling findUsers with args: []\n// findUsers completed in 100ms\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u63a5\u53e3\u793a\u4f8b",children:"\u63a5\u53e3\u793a\u4f8b"}),"\n",(0,s.jsx)(n.h3,{id:"provider-\u63a5\u53e3",children:"Provider \u63a5\u53e3"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"@injectable()\nclass RandomNumberProvider implements Provider<number> {\n  value() {\n    return Math.random();\n  }\n}\n\n// \u7ed1\u5b9a\u63d0\u4f9b\u8005\ncontext.bind('random').toProvider(RandomNumberProvider);\n\n// \u89e3\u6790\u503c\nconst random1 = await context.get<number>('random');\nconst random2 = await context.get<number>('random');\nconsole.log(random1 !== random2); // \u8f93\u51fa: true\n"})}),"\n",(0,s.jsx)(n.h3,{id:"interceptor-\u63a5\u53e3",children:"Interceptor \u63a5\u53e3"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u5b9a\u4e49\u7f13\u5b58\u62e6\u622a\u5668\nclass CachingInterceptor implements Interceptor {\n  private cache = new Map<string, any>();\n\n  intercept(invocationCtx: InvocationContext, next: () => ValueOrPromise<any>) {\n    const cacheKey = `${invocationCtx.targetClass.name}.${invocationCtx.methodName}(${JSON.stringify(invocationCtx.args)})`;\n\n    if (this.cache.has(cacheKey)) {\n      console.log(`Cache hit for ${cacheKey}`);\n      return this.cache.get(cacheKey);\n    }\n\n    console.log(`Cache miss for ${cacheKey}`);\n    const result = next();\n\n    if (result instanceof Promise) {\n      return result.then(value => {\n        this.cache.set(cacheKey, value);\n        return value;\n      });\n    }\n\n    this.cache.set(cacheKey, result);\n    return result;\n  }\n}\n\n// \u4f7f\u7528\u7f13\u5b58\u62e6\u622a\u5668\n@injectable()\nclass ExpensiveService {\n  @intercept(new CachingInterceptor())\n  async computeExpensiveValue(input: string) {\n    console.log(`Computing expensive value for ${input}`);\n    await new Promise(resolve => setTimeout(resolve, 500));\n    return `Result for ${input}`;\n  }\n}\n\n// \u7ed1\u5b9a\u670d\u52a1\ncontext.bind('services.ExpensiveService').toClass(ExpensiveService);\n\n// \u89e3\u6790\u670d\u52a1\u5e76\u8c03\u7528\u65b9\u6cd5\nconst expensiveService = await context.get<ExpensiveService>('services.ExpensiveService');\n\n// \u7b2c\u4e00\u6b21\u8c03\u7528\uff08\u7f13\u5b58\u672a\u547d\u4e2d\uff09\nlet result1 = await expensiveService.computeExpensiveValue('test');\nconsole.log(result1); // \u8f93\u51fa: Result for test\n\n// \u7b2c\u4e8c\u6b21\u8c03\u7528\uff08\u7f13\u5b58\u547d\u4e2d\uff09\nlet result2 = await expensiveService.computeExpensiveValue('test');\nconsole.log(result2); // \u8f93\u51fa: Result for test\n"})}),"\n",(0,s.jsx)(n.h3,{id:"contextobserver-\u63a5\u53e3",children:"ContextObserver \u63a5\u53e3"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u5b9a\u4e49\u89c2\u5bdf\u8005\nclass BindingObserver implements ContextObserver {\n  // \u53ea\u89c2\u5bdf\u5e26\u6709 'service' \u6807\u7b7e\u7684\u7ed1\u5b9a\n  filter = (binding: Readonly<Binding<unknown>>) => binding.tags.has('service');\n\n  observe(eventType: string, binding: Readonly<Binding<unknown>>, context: Context) {\n    console.log(`Event: ${eventType}, Binding: ${binding.key}`);\n  }\n}\n\n// \u521b\u5efa Context \u5e76\u8ba2\u9605\u89c2\u5bdf\u8005\nconst context = new Context('app');\ncontext.subscribe(new BindingObserver());\n\n// \u6dfb\u52a0\u7ed1\u5b9a\uff08\u5c06\u89e6\u53d1\u89c2\u5bdf\u8005\uff09\ncontext.bind('services.UserService').toClass(UserService).tag('service');\n// \u8f93\u51fa: Event: bind, Binding: services.UserService\n\n// \u89e3\u6790\u7ed1\u5b9a\uff08\u5c06\u89e6\u53d1\u89c2\u5bdf\u8005\uff09\nawait context.get('services.UserService');\n// \u8f93\u51fa: Event: resolve:before, Binding: services.UserService\n// \u8f93\u51fa: Event: resolve:after, Binding: services.UserService\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u66f4\u591a\u793a\u4f8b",children:"\u66f4\u591a\u793a\u4f8b"}),"\n",(0,s.jsxs)(n.p,{children:["\u6709\u5173\u66f4\u591a\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605",(0,s.jsx)(n.a,{href:"/contexify/zh/docs/examples/basic-example",children:"\u793a\u4f8b"}),"\u90e8\u5206\u6216\u67e5\u770b ",(0,s.jsx)(n.a,{href:"https://github.com/teomyth/contexify",children:"GitHub \u4ed3\u5e93"}),"\u4e2d\u7684\u793a\u4f8b\u4ee3\u7801\u3002"]})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(g,{...e})}):g(e)}},9880:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>o});var i=t(4700);const s={},r=i.createContext(s);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);